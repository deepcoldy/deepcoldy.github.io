---
date: 2018-02-10
status: public
title: React注意事项
---

## 1. 如果不需要初始化state并且也不需要绑定事件，则不必为你的React组件声明constructor。
``` jsx
constructor(props) { //不必要
  super(props);
}
render() {
    return <div>test</div>
}
```

## 2.请不要在render函数中声明props的默认值，如：
``` js
render() {
    const { counter: [] } = this.props //错误用法
}
```
只需在constructor中`super(props)`即可。

## 3.推荐使用key来初始化组件
``` jsx
<EmailInput
  defaultEmail={this.props.user.email}
  key={this.props.user.id} // key 改变时EmailInput会初始化，有时可以用来重走组件生命周期
/>
```
相关文档[Fully uncontrolled component with a key](https://reactjs.org/blog/2018/06/07/you-probably-dont-need-derived-state.html#recommendation-fully-uncontrolled-component-with-a-key)

## 4.多尝试使用高阶组件做封装

## 5.使用变量控制元素是否显示时，注意转换boolean

可以使用[Demo](https://codesandbox.io/s/5kzrp9y3ql)试一下，如果没有转换为Boolean，将显示`0`。

正确用法：

``` jsx
<div className="App">
  {!!this.state.a && <h1>Hello CodeSandbox</h1>}
  <h2>Start editing to see some magic happen!</h2>
</div>
```

## 6.创建弹层的最佳方式


``` jsx
class Dialog {
    show(children) {
        this.div = document.createElement('div');
        document.body.appendChild(this.div);

        ReactDom.render(children || <div>xxxx</div>, this.div);
    }
    destroy() {
        ReactDom.unmountComponentAtNode(this.div);
        this.div.parentNode.removeChild(this.div);
    }
}
export default {
    show: function(children) {
        dialog = new Dialog();
        dialog.show(children);
    },
};
```

完整版[Demo]{https://codesandbox.io/embed/5y1r5447qx}
