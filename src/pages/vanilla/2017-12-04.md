---
date: 2017-03-03
status: public
title: Extend实现方式
---

## Zepto 的 Extend 实现方式

主要是判断是否为 Object 或 Array，是就进行递归，否则直接赋值。

```js
// 基础判断函数
isArray =
  Array.isArray ||
  function(object) {
    return object instanceof Array
  }
function isWindow(obj) {
  return obj != null && obj == obj.window
}
function isObject(obj) {
  return type(obj) == 'object'
}
function isPlainObject(obj) {
  return (
    isObject(obj) &&
    !isWindow(obj) &&
    Object.getPrototypeOf(obj) == Object.prototype
  )
}

// extend实现
function extend(target, source, deep) {
  for (key in source)
    if (deep && (isPlainObject(source[key]) || isArray(source[key]))) {
      // 如果是Object或Array
      if (isPlainObject(source[key]) && !isPlainObject(target[key]))
        target[key] = {}
      if (isArray(source[key]) && !isArray(target[key])) target[key] = []
      extend(target[key], source[key], deep)
    } else if (source[key] !== undefined) target[key] = source[key]
}

// Copy all but undefined properties from one or more
// objects to the `target` object.
$.extend = function(target) {
  var deep,
    args = slice.call(arguments, 1)
  if (typeof target == 'boolean') {
    deep = target
    target = args.shift()
  }
  args.forEach(function(arg) {
    extend(target, arg, deep)
  })
  return target
}
```
